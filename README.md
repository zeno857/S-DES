# S-DES 加解密程序

## 一、程序概述

帮助用户快速掌握 S-DES 加解密程序的使用方法，涵盖程序启动、基本加解密、ASCII 加解密、暴力破解及密钥分析五大核心功能的操作流程，确保用户能顺利完成数据加密、解密及密钥相关操作。

## 二、环境准备与程序启动

### 运行环境要求

- **Python 版本**：需安装 Python 3.6 及以上版本（推荐 Python 3.8+，以确保 Tkinter 模块兼容稳定）。
- **依赖库**：无需额外安装第三方库，程序仅依赖 Python 标准库（tkinter用于图形界面、threading用于多线程、itertools用于密钥遍历等）。

## 三、核心功能操作指南

程序界面包含 4 个标签页，对应不同功能模块，以下按模块详细说明操作步骤：

### 1. 基本加解密（第 1 关功能：8 位二进制数据加解密）

#### 功能定位

用于 8 位二进制明文与密文的互相转换，适用于基础算法验证、二进制数据加密测试场景。

#### 操作界面说明

- **输入区域**：
  - “8 位明文” 输入框（用于加密时输入原始二进制数据）
  - “10 位密钥” 输入框（加解密时均需输入，且需保持一致）
  - “8 位密文” 输入框（用于解密时输入加密后的二进制数据）

- **按钮区域**：
  - “加密” 按钮（执行明文→密文转换）
  - “解密” 按钮（执行密文→明文转换）
  - “随机生成” 按钮（自动生成 8 位明文和 10 位密钥，方便快速测试）

- **结果区域**：
  - “加密结果” 输入框（显示加密后的 8 位二进制密文，只读不可修改）
  - “解密结果” 输入框（显示解密后的 8 位二进制明文，只读不可修改）
  - “状态” 文本框（显示操作提示，如 “加密成功：01010101 -> 00101010”）

#### 加密操作步骤（明文→密文）

1. 在 “8 位明文” 输入框中输入 8 位二进制数据（仅含 0 和 1，长度必须为 8 位，示例：`01010101`）
2. 在 “10 位密钥” 输入框中输入 10 位二进制密钥（仅含 0 和 1，长度必须为 10 位，示例：`1010101010`）
3. 点击 “加密” 按钮，程序将自动验证输入格式：
   - 若输入格式错误（如含非 0/1 字符、长度不符），将弹出 “输入错误” 提示框（如 “明文必须是 8 位！”“密钥只能包含 0 和 1!”），需修正后重新操作
   - 若输入格式正确，“加密结果” 输入框将显示加密后的 8 位二进制密文（示例：输入明文`01010101`、密钥`1010101010`，加密结果为`00101010`），同时 “状态” 文本框显示 “加密成功” 提示

#### 解密操作步骤（密文→明文）

1. 将加密得到的 8 位二进制密文（或已知的 8 位密文）输入到 “8 位密文” 输入框（示例：`00101010`）
2. 在 “10 位密钥” 输入框中输入与加密时完全相同的 10 位密钥（示例：`1010101010`，密钥不一致将导致解密结果错误）
3. 点击 “解密” 按钮，程序验证输入格式后：
   - 若格式正确，“解密结果” 输入框将显示原始明文（示例：密文`00101010`、密钥`1010101010`，解密结果为`01010101`），“状态” 文本框显示 “解密成功” 提示
   - 若格式错误，弹出 “输入错误” 提示框，需修正后重新操作

#### 辅助功能：随机生成

点击 “随机生成” 按钮，程序将自动生成符合格式要求的 8 位明文和 10 位密钥（如明文`11001010`、密钥`0110011001`），并填充到对应输入框中，适用于无特定测试数据时的快速验证。

### 2. ASCII 加解密（第 3 关功能：字符串加解密）

#### 功能定位

支持任意 ASCII 字符串（如英文、数字、符号）的加解密，按 1Byte（8 位二进制）分组处理，适用于实际文本数据（如文档内容、消息）的加密传输场景。

#### 操作界面说明

- **输入区域**：
  - “明文” 文本框（多行，用于输入待加密的 ASCII 字符串）
  - “10 位密钥” 输入框（与基本加解密模块的密钥格式一致，需 10 位二进制）
  - “密文” 文本框（多行，用于输入待解密的加密字符串）

- **按钮区域**：
  - “加密” 按钮（执行字符串→加密乱码转换）
  - “解密” 按钮（执行加密乱码→原始字符串转换）

- **结果区域**：
  - “加密结果” 文本框（只读，显示加密后的 ASCII 乱码）
  - “解密结果” 文本框（只读，显示解密后的原始字符串）

#### 加密操作步骤（字符串→加密乱码）

1. 在 “明文” 文本框中输入任意 ASCII 字符串（支持英文、数字、符号，如`Hello S-DES! 2024`，不支持中文字符等非 ASCII 编码）
2. 在 “10 位密钥” 输入框中输入 10 位二进制密钥（示例：`1100110011`）
3. 点击 “加密” 按钮，程序将按 1Byte 分组加密字符串：
   - 加密完成后，“加密结果” 文本框将显示加密后的 ASCII 乱码（如`\x9A\x8B\x7C\x6D\x0E\xF1\xA2\xB3\xC4\xD5`，具体乱码内容因密钥不同而变化）
   - 同时，“密文” 文本框将自动同步加密结果，方便后续直接解密操作

#### 解密操作步骤（加密乱码→字符串）

1. 确保 “密文” 文本框中已填入加密后的 ASCII 乱码（可直接使用加密后的同步结果，或手动粘贴其他来源的加密乱码）
2. 在 “10 位密钥” 输入框中输入与加密时完全相同的 10 位密钥（示例：`1100110011`）
3. 点击 “解密” 按钮，程序将按 1Byte 分组解密乱码：
   - 若密钥正确，“解密结果” 文本框将显示原始 ASCII 字符串（如`Hello S-DES! 2024`）
   - 若密钥错误，解密结果将为乱码或无意义字符，需检查密钥是否与加密时一致

### 3. 暴力破解（第 4 关功能：基于明密文对破解密钥）

#### 功能定位

已知 8 位明文和对应的 8 位密文时，通过遍历所有 1024 种（2¹⁰）可能的 10 位密钥，找到所有能将该明文加密为目标密文的密钥，并统计破解耗时，适用于密钥找回、算法安全性验证场景。

#### 操作界面说明

- **输入区域**：
  - “8 位明文” 输入框（需输入已知的原始 8 位二进制明文）
  - “8 位密文” 输入框（需输入与明文对应的 8 位二进制密文）

- **按钮区域**：
  - “开始暴力破解” 按钮（启动破解流程）
  - “停止” 按钮（仅在破解过程中可用，用于中断操作）

- **进度区域**：
  - 进度条（实时显示破解进度，0%~100%）
  - 进度标签（显示当前进度百分比，如 “50.0%”）

- **结果区域**：
  - “破解时间” 输入框（显示破解总耗时，精确到 0.0001 秒）
  - “找到的密钥” 文本框（显示所有匹配的 10 位密钥，每行一个密钥）

#### 破解操作步骤

1. 在 “8 位明文” 输入框中输入已知的 8 位二进制明文（示例：`00000000`）
2. 在 “8 位密文” 输入框中输入与该明文对应的 8 位二进制密文（示例：`11001010`，需确保明密文对正确，否则可能找不到密钥）
3. 点击 “开始暴力破解” 按钮，程序将启动多线程遍历密钥：
   - 进度条和进度标签实时更新破解进度（因密钥仅 1024 种，通常 1 秒内可完成破解）
   - 破解过程中，“开始暴力破解” 按钮变为禁用状态，“停止” 按钮变为可用状态（若需中断，点击 “停止” 即可，进度将重置为 0%）
4. 破解完成后：
   - “破解时间” 输入框显示总耗时（示例：`0.1234秒`）
   - “找到的密钥” 文本框列出所有匹配的密钥（示例：`0000000000`、`0101010101`）
   - 程序将弹出 “完成” 提示框，显示找到的密钥数量（如 “找到 2 个匹配的密钥，耗时 0.1234 秒”）

#### 注意事项

- 明密文对需正确对应（即该密文确实是由该明文通过某 10 位密钥加密得到），否则 “找到的密钥” 文本框将为空，提示框显示 “未找到匹配的密钥”
- 若需测试，可先通过 “基本加解密” 模块生成明密文对（如明文`00000000`、密钥`0000000000`，加密得到密文`11001010`），再用该明密文对进行破解，确保能找到正确密钥

### 4. 密钥分析（第 5 关功能：验证密钥碰撞现象）

#### 功能定位

分析 S-DES 算法的密钥碰撞现象（即不同密钥加密同一明文得到相同密文），通过随机生成明密文对、暴力破解有效密钥，统计密钥数量，验证算法是否存在碰撞，适用于算法特性研究、安全性分析场景。

#### 操作界面说明

- **说明区域**：文本标签（简要说明功能用途，如 “分析 S-DES 算法的密钥碰撞现象，即不同的密钥可能对同一明文加密得到相同的密文”）

- **按钮区域**：
  - “分析随机明密文对的密钥” 按钮（启动分析流程）

- **进度区域**：
  - 进度条（实时显示分析进度，0%~100%）
  - 进度标签（显示当前状态，如 “分析中：50.0%”“分析完成”）

- **结果区域**：
  - “测试明文” 输入框（显示随机生成的 8 位二进制明文）
  - “测试密文” 输入框（显示用随机密钥加密后的 8 位二进制密文）
  - “有效密钥数量” 输入框（显示能生成该密文的密钥总数）
  - “有效密钥列表” 文本框（显示所有有效密钥）
  - “分析时间” 输入框（显示分析总耗时）

#### 分析操作步骤

1. 点击 “分析随机明密文对的密钥” 按钮，程序自动执行以下流程：
   - **步骤 1**：随机生成 1 个 8 位二进制明文（如`01101001`）
   - **步骤 2**：随机选择 1 个 10 位二进制密钥（如`0011001100`），用该密钥加密明文生成密文（如`10010110`）
   - **步骤 3**：暴力破解所有能将该明文加密为该密文的密钥（遍历 1024 种可能）
   - 进度条和进度标签实时更新分析进度（与暴力破解类似，通常 1 秒内完成）
2. 分析完成后：
   - “测试明文”“测试密文” 输入框分别显示随机生成的明密文对
   - “有效密钥数量” 输入框显示统计结果（如`2`，表示有 2 个不同密钥能生成该密文）
   - “有效密钥列表” 文本框列出所有有效密钥（每行一个）
   - “分析时间” 输入框显示总耗时（示例：`0.1567秒`）
   - 程序弹出 “分析结果” 提示框，说明是否存在碰撞（如 “对于明文 01101001 和密文 10010110，找到 2 个有效密钥，说明存在密钥碰撞现象”）

#### 分析结论解读

- **存在碰撞**：若 “有效密钥数量”>1，说明 S-DES 算法存在密钥碰撞（不同密钥加密同一明文得到相同密文），这是由于算法密钥空间（1024 种）远小于明文 - 密文对空间（2⁸×2⁸=65536 种），符合 “鸽巢原理”
- **无碰撞**：若 “有效密钥数量”=1，说明该明密文对仅对应唯一密钥（此类情况占比约 30%-40%，因随机生成的明密文对不同而变化）
